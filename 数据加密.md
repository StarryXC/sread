> Thinking

```
加密原理

Java
MessageDigest
```

> Memory

### Java

```
MessageDigestSpi
    MessageDigest

FilterInputStream
    DigestInputStream

FilterOutputStream
    DigestOutputStream


// MD5 SHA-1
MessageDigest messageDigest = MessageDigest.getInstance("MD5");
byte ret[] = messageDigest.digest("".getBytes());

byte bytes[] = new byte[1];
StringBuilder stringBuilder = new StringBuilder();
for (int i=0;i<bytes.length;i++) {
    String is = Integer.toString(bytes[i]&0xff, 16);
    if (is.length() < 2) {
        stringBuilder.append("0");
    }
    stringBuilder.append(is);
}

StringBuffer stringBuilder = new StringBuffer("");
for (int offset = 0; offset < bytes.length; offset++) {
    int i = bytes[offset];
    if (i < 0)
        i += 256;
    if (i < 16)
        stringBuilder.append("0");
    stringBuilder.append(Integer.toHexString(i));
}


byte b = 1; // 异或文件加密
b ^= 0x99;


public static final String SIGN_ALGORITHMS = "MD5WithRSA";
public static String sign(String content, String privateKeyString) throws Exception {
    PKCS8EncodedKeySpec encodedKeySpec = new PKCS8EncodedKeySpec(Base64.decode(privateKeyString, 0));
    KeyFactory keyFactory = KeyFactory.getInstance("RSA");
    PrivateKey privateKey = keyFactory.generatePrivate(encodedKeySpec);
    Signature signature = Signature.getInstance(SIGN_ALGORITHMS);
    signature.initSign(privateKey);
    signature.update(content.getBytes());
    byte[] signed = signature.sign();
    return Base64.encodeToString(signed, 0);
}
public static boolean doCheck(String content, String sign, String publicKeyString) throws Exception {
    KeyFactory keyFactory = KeyFactory.getInstance("RSA");
    byte[] encodedKey = Base64.decode(publicKeyString, Base64.DEFAULT);
    PublicKey publicKey = keyFactory.generatePublic(new X509EncodedKeySpec(encodedKey));
    Signature signature = Signature.getInstance(SIGN_ALGORITHMS);
    signature.initVerify(publicKey);
    signature.update(content.getBytes());
    return signature.verify(Base64.decode(sign, 0));
}

Base64.encodeToString(new byte[]{}, Base64.DEFAULT);

```

