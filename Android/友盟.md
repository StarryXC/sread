> Thinking

```

```

> Memory

```
Umeng # https://dl.bintray.com/umsdk/release | common analytics utdid push analytics | latest.integration
implementation 'com.umeng.sdk:common:1.5.0'
implementation 'com.umeng.sdk:analytics:7.5.0'
implementation 'com.umeng.sdk:share-core:latest.integration'
implementation 'com.umeng.sdk:share-qq:latest.integration'
implementation 'com.umeng.sdk:share-sina:latest.integration'
implementation 'com.umeng.sdk:share-wechat:latest.integration'

public static final String APP_KEY = "621ccb2e317aa877606c0c38";
public static final String CHANNEL = "NotifyApp";
public static final String MESSAGE_SECRET = "92296cb1234f0c0ce685383b5408f696";

UMConfigure.setLogEnabled(true); // 日志开关

PushAgent.setup(this, APP_KEY, MESSAGE_SECRET); // 预初始化
UMConfigure.preInit(this, APP_KEY, CHANNEL);
UMConfigure.init(this, APP_KEY, CHANNEL, UMConfigure.DEVICE_TYPE_PHONE, MESSAGE_SECRET);

boolean isMainProcess = UMUtils.isMainProgress(this);
if (isMainProcess) {
    //启动优化：建议在子线程中执行初始化
    new Thread(new Runnable() {
        @Override
        public void run() {
            initUmengSDK();
        }
    }).start();
} else {
    //若不是主进程（":channel"结尾的进程），直接初始化sdk，不可在子线程中执行
    initUmengSDK();
}

private void initUmengSDK() { // 初始化友盟SDK
    //获取推送实例
    PushAgent pushAgent = PushAgent.getInstance(this);
    pushAgent.setNotificationOnForeground(true);
    pushAgent.setNotificationPlaySound(MsgConstant.NOTIFICATION_PLAY_SDK_ENABLE);
    pushAgent.setNotificationPlayLights(MsgConstant.NOTIFICATION_PLAY_SDK_ENABLE);
    pushAgent.setNotificationPlayVibrate(MsgConstant.NOTIFICATION_PLAY_SDK_ENABLE);
    //TODO:需修改为您app/src/main/AndroidManifest.xml中package值
    pushAgent.setResourcePackageName("notify.app");
    //设置通知栏显示通知的最大个数（0～10），0：不限制个数
    pushAgent.setDisplayNotificationNumber(3);
    pushAgent.setMessageHandler(new UmengMessageHandler() {
        @Override
        public void dealWithNotificationMessage(Context context, UMessage uMessage) {
            Vibrator vibrator = (Vibrator) getSystemService(VIBRATOR_SERVICE);
            AudioAttributes audioAttributes = new AudioAttributes.Builder()
                    .setUsage(AudioAttributes.USAGE_NOTIFICATION)
                    .build();
            vibrator.vibrate(500, audioAttributes);
            super.dealWithNotificationMessage(context, uMessage);
        }
    });
    //注册推送服务，每次调用register方法都会回调该接口
    pushAgent.register(new UPushRegisterCallback() {
        @Override
        public void onSuccess(String deviceToken) {
            //注册成功会返回deviceToken deviceToken是推送消息的唯一标志
            Log.i(TAG, "deviceToken --> " + deviceToken);
            String alias = "123456";
            String type = "aa";
            PushAgent.getInstance(MainApp.this).setAlias(alias, type, new UPushAliasCallback() {
                @Override
                public void onMessage(boolean success, String message) {
                    Log.i(TAG, "setAlias " + success + " msg:" + message);
                }
            });
        }
        @Override
        public void onFailure(String errCode, String errDesc) {
            Log.e(TAG, "register failure：--> " + "code:" + errCode + ",desc:" + errDesc);
        }
    });
}



```

