> Thinking

```

```

> Memory

### Android

```
BluetoothManager
监听蓝牙状态变化 获取蓝牙状态

BluetoothAdapter bluetoothAdapter = BluetoothAdapter.getDefaultAdapter(); // 无蓝牙 null
if (bluetoothAdapter != null) {
    bluetoothAdapter.isDiscovering(); bluetoothAdapter.startDiscovery(); bluetoothAdapter.cancelDiscovery();
    bluetoothAdapter.isEnabled(); bluetoothAdapter.enable(); bluetoothAdapter.disable();// 蓝牙启用
    Set<BluetoothDevice> bondedDevices = bluetoothAdapter.getBondedDevices(); // 已配对的蓝牙适配器
    bondedDevices.iterator().next().getAddress();
    bondedDevices.iterator().next().getAddress();
}

Intent intent = new Intent(BluetoothDevice.ACTION_FOUND);
BluetoothDevice bluetoothDevice = intent.getParcelableExtra(BluetoothDevice.EXTRA_DEVICE);

// 提示longue开启蓝牙 未开启时使用
Intent intent = new Intent(BluetoothAdapter.ACTION_REQUEST_ENABLE);

// 修改蓝牙设备可见性
Intent intent = new Intent(BluetoothAdapter.ACTION_REQUEST_DISCOVERABLE);
intent.putExtra(BluetoothAdapter.EXTRA_DISCOVERABLE_DURATION, 500); // 可见状态持续时间

ConnectivityManager
NetworkInfo

ConnectivityManager
    getActiveNetworkInfo

NetworkInfo
    isAvailable
    getType ConnectivityManager.TYPE_MOBILE
    getTypeName
    getSubtype
    getSubtypeName

AccountManager
Account

NotificationManager
LoaderManager

SmsManager
SmsMessage

Vibrator android.permission.VIBRATE

Vibrator
    vibrate

WindowManager
Window
Display
DisplayMetrics

WindowManager WINDOW_SERVICE
    getDefaultDisplay

Window getWindow()
    setSoftInputMode WindowManager.LayoutParams.SOFT_INPUT_ADJUST_PAN
    setFlags WindowManager.LayoutParams.FLAG_NOT_TOUCH_MODAL window外可以点击,不拦截窗口外的事件
    addFlags
    clearFlags
    setGravity Gravity.CENTER
    getAttributes WindowManager.LayoutParams
    setAttributes

WindowManager.LayoutParams
    width
    height

Display
    getWidth
    getWidth

Window # activity.getWindow() dialog.getWindow()
	setFormat # PixelFormat.RGBA_8888
	setSoftInputMode # 
		# WindowManager.LayoutParams.SOFT_INPUT_STATE_HIDDEN
	setStatusBarColor setNavigationBarColor
	getCurrentFocus getDecorView findViewById
	setBackgroundDrawable setBackgroundDrawableResource
	hasFeature requestFeature
	setFeatureDrawable setFeatureDrawableAlpha setFeatureDrawableResource setFeatureDrawableUri
	setFeatureInt
	clearFlags addFlags setFlags
		# WindowManager.LayoutParams.FLAG_KEEP_SCREEN_ON 高亮
	setType # 
	FEATURE_NO_TITLE
	FEATURE_ACTION_BAR
	FEATURE_PROGRESS
WindowManager.LayoutParams
	FLAG_FULLSCREEN
	FLAG_DIM_BEHIND
	alpha dimAmount width height packageName
	gravity format flags type token
	buttonBrightness screenBrightness screenOrientation
	horizontalMargin verticalMargin
	horizontalWeight verticalWeight
	systemUiVisibility
	getTitle setTitle
	getColorMode setColorMode
		TYPE_APPLICATION_OVERLAY # O WindowType
		TYPE_SYSTEM_ALERT # WindowType



SensorManager
Sensor
SensorEvent
SensorEventListener

SensorManager
    getSensorList Sensor.TYPE_ALL TYPE_ACCELEROMETER 加速度 重力 陀螺仪 TYPE_LIGHT 光线传感器
    getDefaultSensor 类型默认传感器
    registerListener
    unregisterListener
// 传感器采样率 设置低采样率 省电
SensorManager.SENSOR_DELAY_NORMAL; // 200_000 微妙
SensorManager.SENSOR_DELAY_UI;// 60_000 微妙
SensorManager.SENSOR_DELAY_GAME;// 20_000 微妙
SensorManager.SENSOR_DELAY_FASTEST;// 0微妙

Sensor
    getName 名称
    getVendor 制造商
    getResolution
    getPower 功率
    getType 传感器种类 Sensor.
动作传感器
位置传感器 方向 磁力
环境传感器 温度 压力 亮度

SensorEventListener
    onSensorChanged
    onAccuracyChanged

SensorEvent
    values x y z
    sensor
    timestamp
    accuracy

PreferenceManager
    getDefaultSharedPreferences

PackageManager
PackageInfo
PackageItemInfo

AndroidManifest.xml

PackageManager
	getInstalledApplications
ApplicationInfo
PackageItemInfo
	packageName
	appInfo.loadLabel(packageManager);
	appInfo.loadIcon(packageManager);

String packageName = context.getPackageName();
PackageManager packageManager = context.getPackageManager();
List<PackageInfo> packageInfos = packageManager.getInstalledPackages(0);
packageInfos.get(0).packageName;
packageInfos.get(0).versionName;
packageInfos.get(0).versionCode;

// 未安装apk
PackageInfo packageInfo = packageManager.getPackageArchiveInfo("", PackageManager.GET_META_DATA);

FeatureInfo[] featureInfos = packageManager.getSystemAvailableFeatures();
switch (featureInfos[0].name) {
    case PackageManager.FEATURE_CAMERA_FLASH:
}

List<ResolveInfo> resInfoList = packageManager.queryIntentActivities(new Intent(), PackageManager.MATCH_DEFAULT_ONLY);
String packageName = resInfoList.get(0).activityInfo.packageName;
int gids[] = packageManager.getPackageGids("");

PackageManager
	PERMISSION_GRANTED

PackageManager
	PERMISSION_GRANTED

PackageManager packageManager = context.getPackageManager();
			PackageInfo packageInfo = packageManager.getPackageInfo(
					context.getPackageName(), 0);
			int labelRes = packageInfo.applicationInfo.labelRes;
			return context.getResources().getString(labelRes);
			
packageInfo.versionName;
packageInfo.versionCode;

android.permission.INTERNET 访问网络
android.permission.CAMERA # 访问相机
android.permission.ACCESS_FINE_LOCATION # GPS定位 网络定位
android.permission.ACCESS_COARSE_LOCATION # 网络定位 信号接收塔 WiFi接入点
@android:style/Theme.Translucent.NoTitleBar.Fullscreen

android.permission.ACCESS_WIFI_STATE 访问wifi网络信息，可用于网络定位
android.permission.ACCESS_NETWORK_STATE 获取运营商信息
android.permission.CHANGE_WIFI_STATE 改变wifi状态权限
android.permission.READ_PHONE_STATE 读取手机当前状态
android.permission.WRITE_EXTERNAL_STORAGE 向扩展存储写入数据
android.permission.READ_EXTERNAL_STORAGE
android.permission.MOUNT_UNMOUNT_FILESYSTEMS SD卡读取权限
android.permission.INTERACT_ACROSS_USERS_FULL
android.permission.RECORD_AUDIO
android.permission.READ_LOGS
android.permission.GET_TASKS
android.permission.SET_DEBUG_APP
android.permission.SYSTEM_ALERT_WINDOW
android.permission.GET_ACCOUNTS
android.permission.MANAGE_ACCOUNTS
android.permission.USE_CREDENTIALS
android.permission.MANAGE_ACCOUNTS
android.permission.WRITE_APN_SETTINGS
android.permission.READ_CONTACTS
android.permission.FLASHLIGHT

android.permission.VIBRATE
android.permission.INTERNET
android.permission.RECORD_AUDIO
android.permission.CAMERA
android.permission.ACCESS_NETWORK_STATE
android.permission.ACCESS_MOCK_LOCATION
android.permission.WRITE_EXTERNAL_STORAGE
android.permission.MOUNT_UNMOUNT_FILESYSTEMS
android.permission.ACCESS_FINE_LOCATION
android.permission.GET_TASKS
android.permission.ACCESS_WIFI_STATE
android.permission.CHANGE_WIFI_STATE
android.permission.WAKE_LOCK
android.permission.MODIFY_AUDIO_SETTINGS
android.permission.READ_PHONE_STATE
android.permission.RECEIVE_BOOT_COMPLETED

android.permission.READ_PRIVILEGED_PHONE_STATE

SEND_SMS
CALL_PHONE
RECORD_AUDIO
READ_EXTERNAL_STORAGE WRITE_EXTERNAL_STORAGE
CAMERA
RECORD_AUDIO
<supports-screens
    android:anyDensity="true"
    android:largeScreens="true"
    android:normalScreens="true"
    android:resizeable="true"
    android:smallScreens="true" />
AndroidManifest.xml
<application>
    android:usesCleartextTraffic="true" android 9.0 强制使用https的问题
    android:allowBackup
    	<icon> <label> <name> <theme>
<uses-library>
    android:name="org.apache.http.legacy" android:required="false" android 9.0 使用 httpclient
<provider>
    android:name="androidx.core.content.FileProvider" android 7.0 访问file
    android:authorities="${applicationId}.fileProvider"
    android:grantUriPermissions="true"
    android:exported="false"
<meta-data>
    android:name="android.support.FILE_PROVIDER_PATHS"
    android:resource="@xml/file_paths"
file_paths
<paths>
<external-path>
	path # . 目录
	name # external_storage_root
@android:style/Theme.Light.NoTitleBar.Fullscreen
<intent-filter>
    <action android:name="android.intent.action.VIEW" />
    <category android:name="android.intent.category.DEFAULT" />
    <category android:name="android.intent.category.BROWSABLE" />
    <data>
        android:scheme="http"
        android:host="baidu.com"
        android:mimeType="image/jpeg"

Features
android.hardware.camera
android.hardware.camera.autofocus
android.hardware.camera.front
android.hardware.camera.front.autofocus

<uses-feature
    android:name="android.hardware.camera"
    android:required="true"/>
<uses-feature
    android:name="android.hardware.camera.autofocus"
    android:required="true"/>
    <uses-permission android:name="android.permission.CAMERA"/>
    <uses-permission android:name="android.permission.FLASHLIGHT"/>
    <uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE"/>
    <uses-permission android:name="android.permission.READ_EXTERNAL_STORAGE"/>
Categorys
Intent.CATEGORY_LAUNCHER android.intent.category.LAUNCHER
android.intent.category.DEFAULT
android.intent.category.OPENABLE
android.intent.category.BROWSABLE


Actions
Intent.ACTION_MAIN android.intent.action.MAIN
android.intent.action.VIEW
android.intent.action.GET_CONTENT

Intent.ACTION_BATTERY_CHANGED
boolean onBatteryNow = intent.getIntExtra(
						BatteryManager.EXTRA_PLUGGED, -1) <= 0;

Context
	<packageName>
PackageManager
	<packageInfo>
PackageInfo
	<version>
	
系统权限定义
Manifest.permission
	INTERNET

PowerManager
WakeLock

DownloadManager
DownloadManager Context.DOWNLOAD_SERVICE

DownloadManager downloadManager = (DownloadManager) getSystemService(Context.DOWNLOAD_SERVICE);
DownloadManager.Query query = new DownloadManager.Query();
Cursor cursor = downloadManager.query(query);
if (!cursor.moveToFirst()) {
    // "无下载内容"
}
do {
    int status = cursor.getInt(cursor.getColumnIndex(DownloadManager.COLUMN_STATUS));
    String title = cursor.getString(cursor.getColumnIndex(DownloadManager.COLUMN_TITLE));
    if (title.equals("title")) {
        switch (status) {
            case DownloadManager.STATUS_SUCCESSFUL:
                String uri = cursor.getString(cursor.getColumnIndex(DownloadManager.COLUMN_LOCAL_URI));
                // 下载完成
                break;
            case DownloadManager.STATUS_RUNNING:
            case DownloadManager.STATUS_PAUSED:
            case DownloadManager.STATUS_PENDING:
                // 正在下载
                break;
            default:
                // 失败也视为可以再次下载
        }
        break;
    }
} while (cursor.moveToNext());

long enqueueId = 0;
query.setFilterById(enqueueId);
cursor = downloadManager.query(query);
if (cursor.moveToFirst()) {
    int columnIndex = cursor.getColumnIndex(DownloadManager.COLUMN_STATUS);
    if (DownloadManager.STATUS_SUCCESSFUL == cursor.getInt(columnIndex)) {
        String uri = cursor.getString(cursor.getColumnIndex(DownloadManager.COLUMN_LOCAL_URI));
//                return Uri.parse(uri);根据下载队列id获取下载Uri
    }
}

DownloadManager.Request request = new DownloadManager.Request(Uri.parse("parse"));
request.setDestinationInExternalPublicDir(Environment.DIRECTORY_DOWNLOADS, "downloadName");
request.setNotificationVisibility(DownloadManager.Request.VISIBILITY_VISIBLE_NOTIFY_COMPLETED);
request.setMimeType("application/vnd.android.package-archive");
downloadManager.enqueue(request);

DownloadManager.ACTION_DOWNLOAD_COMPLETE action
long enqueueId = intent.getLongExtra(DownloadManager.EXTRA_DOWNLOAD_ID, 0);
Uri uri = DownloadHelperSys.getDownloadUriById(context, enqueueId);


ActivityManager

RunningAppProcessInfo
MemoryInfo
ProcessErrorStateInfo
RunningTaskInfo
RunningServiceInfo
RecentTaskInfo

ActivityManager activityManager = (ActivityManager) getSystemService(Context.ACTIVITY_SERVICE);

ActivityManager.MemoryInfo memoryInfo = new ActivityManager.MemoryInfo();
activityManager.getMemoryInfo(memoryInfo);
memoryInfo.totalMem; // 总内存
memoryInfo.availMem; // 可用内存
memoryInfo.threshold; // 临界值，达到这个值，进程就要被杀死
memoryInfo.lowMemory; // 最低内存

List<ActivityManager.RunningAppProcessInfo> runningAppProcesses = activityManager.getRunningAppProcesses();
runningAppProcesses.get(0).pid;
runningAppProcesses.get(0).uid;
runningAppProcesses.get(0).lru;
runningAppProcesses.get(0).processName;
runningAppProcesses.get(0).importance;
runningAppProcesses.get(0).importanceReasonCode;

// RECENT_WITH_EXCLUDED=1,RECENT_IGNORE_UNAVAILABLE=2
List<ActivityManager.RecentTaskInfo> recentTasks = activityManager.getRecentTasks(5, 1);
recentTasks.get(0).baseIntent; // 触发该任务的Intent
recentTasks.get(0).description; // 描述性文字
recentTasks.get(0).id; // 如果是运行中的TASK，唯一标识该任务，如果不是，为-1
recentTasks.get(0).origActivity; // 触发任务的第一个 activity
recentTasks.get(0).persistentId; // 当前任务的唯一标识

List<ActivityManager.RunningServiceInfo> runningServices = activityManager.getRunningServices(5);
runningServices.get(0).service; // 服务组件名
runningServices.get(0).clientPackage;
runningServices.get(0).process;
runningServices.get(0).activeSince; // 开始时间
runningServices.get(0).clientCount; // 连接到服务的客户数量
runningServices.get(0).clientLabel; // 标识特殊服务
runningServices.get(0).crashCount; // 运行过程中奔溃的次数
runningServices.get(0).flags;
runningServices.get(0).lastActivityTime; // 最后服务结束的时间
runningServices.get(0).restarting; // 如果非0,代表服务没启动,计划启动
runningServices.get(0).foreground; // 是否处于处于最前面的服务状态
runningServices.get(0).started; // 服务以后已经开启
runningServices.get(0).pid;
runningServices.get(0).uid;

// 获得系统里正在运行的所有进程
List<ActivityManager.RunningTaskInfo> runningTasks = activityManager.getRunningTasks(5);
runningTasks.get(0).baseActivity; // 任务主activity名
runningTasks.get(0).description; // 任务的描述
runningTasks.get(0).id; // 任务的id号
runningTasks.get(0).numActivities; // 该任务的activity的数量
runningTasks.get(0).numRunning; // 当前活动的activity数量
runningTasks.get(0).thumbnail;
runningTasks.get(0).topActivity; // 当前活动activity中处于最顶端的activity
runningTasks.get(0).describeContents(); // 描述文本

List<ActivityManager.ProcessErrorStateInfo> processesInErrorState = activityManager.getProcessesInErrorState();
processesInErrorState.get(0).condition; // 进程进入的条件
processesInErrorState.get(0).crashData; // crash数据
processesInErrorState.get(0).longMsg; // 对条件condition的描述
processesInErrorState.get(0).processName;
processesInErrorState.get(0).pid;
processesInErrorState.get(0).shortMsg;
processesInErrorState.get(0).stackTrace; // 堆栈追踪到的信息
processesInErrorState.get(0).tag; // activity名是否与错误有关联
processesInErrorState.get(0).uid;
processesInErrorState.get(0).describeContents(); // 数据包裹的描述

activityManager.clearApplicationUserData();
Debug.MemoryInfo[] processMemoryInfo = activityManager.getProcessMemoryInfo(new int[]{Process.myPid()});


InputMethodManager
InputMethodManager # Context.INPUT_METHOD_SERVICE
	showSoftInput # 显示软键盘 InputMethodManager.SHOW_FORCED View.requestFocus
	hideSoftInputFromWindow # 隐藏键盘 (editText.getWindowToken(),0) InputMethodManager.HIDE_NOT_ALWAYS

TelephonyManager
PhoneStateListener
<uses-permission android:name="android.permission.READ_PHONE_STATE" />
<uses-permission android:name="android.permission.READ_CALL_LOG" />

requestPermissions(new String[] {Manifest.permission.READ_PHONE_STATE, Manifest.permission.READ_CALL_LOG}, 100);

// 成员变量
PhoneStateListener phoneStateListener = new PhoneStateListener() {
    @Override
    public void onCallStateChanged(int state, String phoneNumber) {
        switch (state) {
            case TelephonyManager.CALL_STATE_RINGING: // 响铃状态
            case TelephonyManager.CALL_STATE_OFFHOOK: // 接听或拨打状态
            case TelephonyManager.CALL_STATE_IDLE: // 挂断状态
        }
    }
};
TelephonyManager telephonyManager = (TelephonyManager) getSystemService(Context.TELEPHONY_SERVICE);
// 监听通话 LISTEN_CALL_STATE 取消监听 LISTEN_NONE
telephonyManager.listen(phoneStateListener, PhoneStateListener.LISTEN_CALL_STATE);
telephonyManager.getDeviceId(); // 获取手机IMEI(需要“android.permission.READ_PHONE_STATE”权限)

AlarmManager
Context.ALARM_SERVICE 闹钟

	set # (AlarmManager.RTC_WAKEUP,calendar.getTimeInMillis(),pendingIntent)
		# RTC_WAKEUP RTC

LocationManager
Geocoder
Geocoder geocoder = new Geocoder(context);
List<Address> addressList = geocoder.getFromLocation(40.714, -73.961, 1);

LocationManager locationManager = (LocationManager) context.getSystemService(Context.LOCATION_SERVICE);
if (ActivityCompat.checkSelfPermission(context, Manifest.permission.ACCESS_FINE_LOCATION) != PackageManager.PERMISSION_GRANTED
        && ActivityCompat.checkSelfPermission(context, Manifest.permission.ACCESS_COARSE_LOCATION) != PackageManager.PERMISSION_GRANTED) {
}
locationManager.getAllProviders();

Criteria criteria = new Criteria(); // 设置查询条件 查询Location Provider
criteria.setAccuracy(Criteria.ACCURACY_FINE);
criteria.setPowerRequirement(Criteria.POWER_LOW);
criteria.setAltitudeRequired(false);
criteria.setSpeedRequired(false);
criteria.setCostAllowed(false);
locationManager.getBestProvider(criteria, false);

locationManager.requestLocationUpdates(LocationManager.GPS_PROVIDER, 5000, 5000, new LocationListener() {
    @Override
    public void onLocationChanged(Location location) { }
    @Override
    public void onStatusChanged(String provider, int status, Bundle extras) { }
    @Override
    public void onProviderEnabled(String provider) { }
    @Override
    public void onProviderDisabled(String provider) { }
});

http://maps.googleapis.com/maps/api/geocode/json?
    address=sdd
    bounds=34.34,-118|34.23,-118.23
    sensor=false
    latlng=40.12,-73.we
    region=es

WifiManager
WifiConfiguration
WifiInfo
WifiManager wifiManager = (WifiManager) getSystemService(Context.WIFI_SERVICE);
wifiManager.setWifiEnabled(true); // 禁用启动网卡
wifiManager.removeNetwork(1);
WifiConfiguration wifiConfiguration = new WifiConfiguration();
int network = wifiManager.addNetwork(wifiConfiguration);
wifiManager.enableNetwork(1, true);
wifiManager.saveConfiguration();

switch (wifiManager.getWifiState()) { // 网卡状态
    case WifiManager.WIFI_STATE_DISABLED:
        break;
}

WifiInfo wifiInfo = wifiManager.getConnectionInfo();
int ipAddress = wifiInfo.getIpAddress();
String ip = String.format("%d.%d.%d.%d",
        (ipAddress & 0xff),
        (ipAddress >> 8 & 0xff),
        (ipAddress >> 16 & 0xff),
        (ipAddress >> 24 & 0xff));

Enumeration<NetworkInterface> en = NetworkInterface.getNetworkInterfaces();
while (en.hasMoreElements()) {
    NetworkInterface networkInterface = en.nextElement();
    Enumeration<InetAddress> inetAddressEnumeration = networkInterface.getInetAddresses();
    while (inetAddressEnumeration.hasMoreElements()) {
        InetAddress ip = inetAddressEnumeration.nextElement();
        if (!ip.isLoopbackAddress() && InetAddressUtils.isIPv4Address(ip.getHostAddress())) {
            String hostAddress = ip.getHostAddress();
        }
    }
}

StorageManager
StorageManager storageManager = (StorageManager) getSystemService(Context.STORAGE_SERVICE);
// getVolumeList
// getVolumePaths
// getVolumeState

// android.os.storage.StorageVolume
// getPathFile
// getDescriptionId
// isPrimary
// isRemovable
// isEmulated
// getStorageId
// allowMassStorage
// getMaxFileSize
// getMtpReserveSpace

ClipboardManager
ClipData
ClipboardManager clipboardManager = (ClipboardManager) context.getSystemService(Context.CLIPBOARD_SERVICE);
ClipData clipData = clipboardManager.getPrimaryClip(); clipboardManager.setPrimaryClip(ClipData.newPlainText("", ""));
clipData.getItemCount();
ClipData.Item item = clipData.getItemAt(0);
item.coerceToHtmlText(context);
item.coerceToStyledText(context);

NetworkStatsManager
NetworkStatsManager networkStatsManager = (NetworkStatsManager) getSystemService(Context.NETWORK_STATS_SERVICE);
networkStatsManager.registerUsageCallback(0, "", 0L, new NetworkStatsManager.UsageCallback() {
    @Override
    public void onThresholdReached(int i, String s) { }
});

MediaProjectionManager
MediaProjectionManager mediaProjectionManager = (MediaProjectionManager) getSystemService(Context.MEDIA_PROJECTION_SERVICE);
Intent intent = mediaProjectionManager.createScreenCaptureIntent();
startActivityForResult(intent, 100);

MediaProjection mediaProjection = mediaProjectionManager.getMediaProjection(resultCode, data);
MediaCodec mediaCodec = MediaCodec.createEncoderByType("video/avc");
MediaFormat mediaFormat = MediaFormat.createVideoFormat("video/avc", 720, 1280);
mediaFormat.setInteger(MediaFormat.KEY_COLOR_FORMAT, MediaCodecInfo.CodecCapabilities.COLOR_FormatSurface);
mediaFormat.setInteger(MediaFormat.KEY_BIT_RATE, 400_000);
mediaFormat.setInteger(MediaFormat.KEY_FRAME_RATE, 15);
mediaFormat.setInteger(MediaFormat.KEY_I_FRAME_INTERVAL, 2);
mediaCodec.configure(mediaFormat, null, null, MediaCodec.CONFIGURE_FLAG_ENCODE);
Surface surface = mediaCodec.createInputSurface();
VirtualDisplay virtualDisplay = mediaProjection.createVirtualDisplay(
        "screen-codec",
        720, 1280, 1,
        DisplayManager.VIRTUAL_DISPLAY_FLAG_PUBLIC,surface, null, null);

mediaCodec.start();
MediaCodec.BufferInfo bufferInfo = new MediaCodec.BufferInfo();
long time = System.currentTimeMillis();

long startTime = bufferInfo.presentationTimeUs / 1000;
OutputStream outputStream = new FileOutputStream("");
int index = mediaCodec.dequeueOutputBuffer(bufferInfo, 100_000);// 微妙
if (index >= 0) {
    if (System.currentTimeMillis() - time >= 2000) { // 2s 关键帧
        Bundle bundle = new Bundle();
        bundle.putInt(MediaCodec.PARAMETER_KEY_REQUEST_SYNC_FRAME, 0);
        mediaCodec.setParameters(bundle);
        time = System.currentTimeMillis();
    }
    ByteBuffer byteBuffer = mediaCodec.getOutputBuffer(index);
    byte[] outData = new byte[bufferInfo.size];
    byteBuffer.get(outData);
    long duration = bufferInfo.presentationTimeUs / 1000 - startTime;
    outputStream.write(outData);
    outputStream.write('\n');
    mediaCodec.releaseOutputBuffer(index, false);
}



```

